"0","M.abc <- M.2 %>%"
"0","  left_join(M.0) %>%   #幫M.2這樣區樣點加回座標等資訊"
"0","  mutate(Y_S_S = paste0(Year, ""_"", Survey, ""_"",Site_N)) %>% "
"0","  st_as_sf(., coords = c(""TWD97_X"", ""TWD97_Y""), crs = 3826) %>% "
"0","  split(., .$Y_S_S) %>% "
"0","  lapply(., function(x){"
"0",""
"0","    dist <-   "
"0","      st_distance(x$geometry)    #算點與點間的距離"
"0","    "
"0","      colnames(dist) <- x$Point         #加colnames"
"0","      "
"0","      dist %>% "
"0","      as.data.frame() %>%   #轉回長表格"
"0","      setNames(., x$Point) %>% "
"0","      add_column(Base_point = x$Point) %>% "
"0","      reshape2::melt(id.vars = ""Base_point"", variable.name = ""Nearest_point"", value.name = ""distance"")%>%  "
"0","      filter(!distance %in% 0) %>% "
"0","        arrange(Base_point)"
"0","    }) %>% "
"0","  bind_rows(.id = ""Y_S_S"") %>% "
"0","  separate(""Y_S_S"", c(""Year"", ""Survey"",""Site_N""), ""_"") %>% "
"0","  mutate(distance = as.numeric(distance)) %>% "
"0","  mutate(Nearest_point = Nearest_point %>% as.character() %>% as.numeric()) %>% "
"0","  mutate(Base_point = as.numeric(Base_point))"
"2","Joining, by = c(""Year"", ""Survey"", ""Site_N"")"
