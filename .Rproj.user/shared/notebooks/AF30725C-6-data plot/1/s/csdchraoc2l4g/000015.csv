"0","#  Region、猴群數、樣區數"
"0",""
"0","E_rate_Region<- "
"0","  M.data %>%"
"0","  bind_rows( M.data %>% mutate(Region2='TW') ) %>%"
"0","  "
"0","  filter(analysis %in% ""Y"") %>%"
"0","  group_by(Year, Survey, Region2) %>% "
"0","  summarise("
"0","    N= n(),"
"0","    m = sum(Macaca_sur,na.rm=T) )  %>% "
"0","  mutate(E = (m/N) %>% round(.,3)) %>%"
"0","  ungroup() %>% "
"0","  reshape2::melt(id = 1:3) %>% "
"0","  reshape2::dcast(Region2 + variable ~ Year + Survey,"
"0","                  value.var = ""value"") %>% "
"0","  reshape2::melt(id = 1:2, variable.name = ""variable2"")  %>% "
"0","  "
"0","  bind_rows(     #增加各region2的mean、se部分"
"0","    group_by(., Region2, variable) %>% "
"0","      summarise("
"0","        Mean = mean(value),"
"0","        Se = sd(value)/sqrt(length(value))"
"0","      ) %>% "
"0","  reshape2::melt(id = 1:2, variable.name = ""variable2"")"
"0","  ) %>% "
"0","  mutate(value = ifelse("
"0","    variable == ""E"","
"0","    sprintf(""%06.4f"",value),"
"0","    ifelse("
"0","      variable2 %in% c(""Mean"", ""Se""),"
"0","      sprintf(""%0.1f"",value),"
"0","      value"
"0","    )"
"0","  )) %>% "
"0","  "
"0","  reshape2::dcast(Region2 + variable ~ variable2,"
"0","                  value.var = ""value"") %>% "
"0","  mutate(variable = ordered( variable, c(""N"", ""m"", ""E""))) %>% "
"0","  mutate(Region2 = ordered(Region2, c(""North"",""Center"","
"0","                                      ""South"",""Southwest"","
"0","                                      ""Hualien"",""Taitung"","
"0","                                      ""TW""))) %>% "
"0","  arrange(Region2)"
"2","`summarise()` has grouped output by 'Year', 'Survey'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'Region2'. You can override using the `.groups` argument."
