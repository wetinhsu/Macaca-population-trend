mutate(檢核補充說明 = case_when(
Site_N == "MA-D16-05" & Point == 7 ~ "今年調查的樣點1與去年位置不同，(比較接近2019年設置的位置)，故改樣點代號為7",
Site_N == "MA-D16-04" & Point == 2 ~ "誤差大於50m，表訂的樣點2在森林步道上",
Site_N == "MA-H34-08" & Point == 5 & Survey %in% 1 ~ "誤差大於50m",
Site_N == "MA-H34-03" & Point == 2 & Survey %in% 1~ "照片判定兩旅次不在相同位置",
Site_N == "MA-H31-09" & Point == c(3,4) ~ "兩旅次照片相符，因為照片地點在既成道路上，可是表定樣點是點在100m的森林邊。(當初為了森林移了點，現在的位置在移點前)",
Site_N == "MA-H32-06" & Point == 1 ~ "需與調查人員再討論",
Site_N == "MB-E19-12" & Point == 2 ~ "需與調查人員確認，因兩旅次皆與表訂座標誤差大於50m",
Site_N == "MB-E19-13" & Point == 6 & X %in% c(242242, 242251)~ "需與調查人員確認，因為也不是樣點7的位置，若要成為新樣點距離也符合200m",
Site_N == "MA-E19-01" & Point == 5 & Survey %in% 2  ~ "與表訂座標誤差大於50m，因無第2旅次的GPS或環境照片所以無法證明是否是GPS誤差",
Site_N == "MA-E19-08" & Point == 4 & Survey %in% 2  ~ "與表訂座標誤差大於50m，因無第2旅次的GPS或環境照片所以無法證明是否是GPS誤差",
Site_N == "MA-E19-02" & Point == 4 & Survey %in% 1  ~ "與表訂座標誤差大於50m，因無第2旅次的GPS或環境照片所以無法證明是否是GPS誤差",
Site_N == "MA-E19-02" & Point == 6~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-03" & Point == 1~ "與表訂座標誤差大於50m，環境照片用街景確認過，調查位置不再表定位置",
Site_N == "MC-E20-05" & Point == 6~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-04" & Point == 1~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-04" & Point == 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-13" & Point == 3 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-13" & Point == 4 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-13" & Point == 5 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-01" & Point == 3~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-12" & Point == 6 & X %in% c(229299, 229304)~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-07" & Point == 1 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-07" & Point == 2 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-07" & Point == 4 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-07" & Point == 5 & Survey %in% 2~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-07" & Point == 6 & Survey %in% 1~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-08" & Point == 1 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-08" & Point == 2 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-08" & Point == 3 & X %in% c(229883, 229793) ~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-11" & Point == 5 & X %in% c(229214, 229213) ~ "與表訂座標誤差大於50m",
Site_N == "MB-E20-11" & Point == 6 & X %in% c(229102, 229101) ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-08" & Point == 6 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-06" & Point == 4 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-03" & Point == 4 & Survey %in% 1 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-03" & Point == 5 & Survey %in% 1 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E21-09" & Point == 4 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E21-11" & Point == 3 & Survey %in% 1 ~ "樣點3與樣點4的座標一模一樣，照片也模一樣",
Site_N == "MA-E21-11" & Point == 1 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E21-11" & Point == 2 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E21-11" & Point == 3 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-05" & Point == 1 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-05" & Point == 2 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MB-E21-05" & Point == 5 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-10" & Point == 2 ~ "與表訂座標誤差大於50m，環境照片用街景確認過，調查位置不再表定位置",
Site_N == "MA-E22-10" & Point == 3 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-10" & Point == 5 & Survey %in% 1 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-05" & Point == 4 & Survey %in% 1 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-05" & Point == 3 & X %in% c(212492)~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-05" & Point == 5 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-05" & Point == 6 & Survey %in% 2 ~ "與表訂座標誤差大於50m",
Site_N == "MA-E22-12" & Point == 6 ~ "與表訂座標誤差大於50m",
TRUE ~ 檢核補充說明)) %>%
mutate(檢核 = case_when(
Site_N == "MB-H33-04" & Point == 5 & Survey %in% 1~ str_replace(檢核, "、座標|^座標$", "") ,#位置相同，GPS機器誤差過大
Site_N == "MA-H33-12" & Point == 1 & Survey %in% 1~ str_replace(檢核, "、座標|^座標$", ""),#街景與照片相符，GPS機器誤差過大
Site_N == "MA-H32-08" & Point == 4 & Survey %in% 1~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MA-H32-08" & Point == 1 ~ str_replace(檢核, "^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MB-H33-02" & Point == 5 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MA-H33-13" & Point %in% c(1, 5) ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MA-C13-09" & Point %in% c(1)& Survey %in% 1 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MB-C13-10" & Point %in% c(5)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，調查表筆誤
Site_N == "MB-C13-11" & Point %in% c(4, 5)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，調查表筆誤
Site_N == "MA-C12-04" & Point %in% c(5)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，調查表筆誤
Site_N == "MA-G28-06" & Point %in% c(1)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
Site_N == "MA-G28-12" & Point %in% c(4)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#50.多，給過吧
Site_N == "MB-A01-06" & Point %in% c(6)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#50.多，給過吧
Site_N == "MA-A01-02" & Point %in% c(1)& Survey %in% 2 ~ str_replace(檢核, "、座標|^座標$", ""),#50.多，給過吧
Site_N == "MA-A03-07" & Point %in% c(5)& Survey %in% 1 ~ str_replace(檢核, "、座標|^座標$", ""),#兩旅次照片相符，GPS機器誤差過大
TRUE ~ 檢核)) %>%
#------
mutate(`TWD97_X` = `X`, `TWD97_Y` = `Y`) %>%
st_as_sf(., coords=c("X", "Y"), crs = 3826) %>%
st_transform(4326) %>%
bind_cols(., as.data.frame(st_coordinates(.)))  %>%
st_drop_geometry() %>%
mutate(X = as.numeric(X) %>% round(5), Y = as.numeric(Y) %>% round(5))
df %>%
filter(檢核 %in% str_subset(`檢核`, "座標")) %>%
filter(Site_N %in% .$Site_N) %>%
select(Site_N) %>% unique() %>%
left_join(., df)%>%
filter(林管處 %in% "羅東") %>%
write.csv("D:/待處理工作夾(做完要歸檔)/Foresty2021_羅東.csv",row.names=F)
Point_list %>%
bind_cols(., as.data.frame(st_coordinates(.)))  %>%
st_drop_geometry() %>%
select(-Name) %>%
setNames(., c("Site_N", "Point", "樣點表_X", "樣點表_Y")) %>%
left_join(df, .) %>%
filter(林管處 %in% "羅東") %>%
select(
檢核,
林管處,
工作站,
"樣區名稱" = Name,
"樣區編號" = Site_N,
年,
月,
日,
調查者,
"旅次" = Survey,
"樣點代號" = Point,
TWD97_X,
TWD97_Y,
時,
分,
數量,
距離,
叫聲,
"棲地類型"  = Habitat,
備註,
樣點表_X,
樣點表_Y
) %>%
split(.$林管處) %>%
lapply(., function(x){
wb <- createWorkbook()
x %>%
split(., .$工作站) %>%
lapply(., function(y){
addWorksheet(wb, unique(y$工作站))
addFilter(wb,  sheet = unique(y$工作站), row = 1, cols = 2:ncol(y))
writeData(wb, sheet = unique(y$工作站), x = y, startCol = 3)
paste0("黃底色為需修正或再確認處。", "\n",
"藍底色為下次調查需改善處。", "\n",
"\n",
"\n",
"座標：請參考附件<樣點地圖>。", "\n",
"6分鐘：每個樣點需調查滿6分鐘。", "\n",
"7日：同一樣區同一旅次，需在7日內完成。", "\n",
"太晚：需在11點前完成調查。", "\n",
"叫聲：獼猴叫聲是猴群間溝通聯絡的聲音，表示附近有猴群。", "\n"
) %>%
writeData(wb, sheet = unique(y$工作站), x = .,startRow = 2, startCol = 1)
paste0( "檢核說明") %>%
writeData(wb, sheet = unique(y$工作站), x = .,startRow = 1, startCol = 1)
paste0( "工作站回覆") %>%
writeData(wb, sheet = unique(y$工作站), x = .,startRow = 1, startCol = 2)
saveWorkbook(wb,
paste0(path3,unique(y$林管處),"_初檢核_",format(Sys.Date(),"%m%d"),".xlsx"),
overwrite = TRUE)
})
})
setwd("D:/R/test/Macaca-population-trend")
######## Data Source:2015-2019 Macaca analisis ######
#---- load library
library(data.table)
library(magrittr)
library(readxl)
library(tidyr)
library(purrr)
library(dplyr)
library(writexl)
library(ggplot2)
#Original data----
M.data <- read_excel("./data/clean/for analysis_V1.xlsx",
sheet=1) %>% setDT %>%
#  .[analysis %in% "Y",] %>%
.[, TypeName.1 := ordered(TypeName.1,c("闊葉林",
"針葉林",
"混淆林",
"竹林",
"非森林"))] %>%
.[, County := ordered(County,
c("宜蘭縣","基隆市","台北市","臺北市",
"新北市","台北縣","臺北縣",
"桃園縣","桃園市","新竹市",
"新竹縣","苗栗縣",
"台中市","臺中市","台中縣","臺中縣",
"彰化縣","南投縣","南投市",
"雲林縣","嘉義縣","嘉義市",
"台南市","臺南市","台南縣","臺南縣",
"高雄縣","高雄市",
"屏東縣", "花蓮縣",
"台東縣","臺東縣"))]  %>%
.[, Year := as.numeric(Year)] %>%
.[, Survey := as.numeric(Survey)] %>%
.[, Point := as.numeric(Point)] %>%
.[, Macaca_sur := as.numeric(Macaca_sur)] %>%
.[, Month := as.numeric(Month)] %>%
.[, Day := as.numeric(Day)] %>%
.[, Distance := as.numeric(Distance)]
#--------------------------
Year.d <-
M.data %>%
.[analysis %in% "Y",] %>%
.[!(TypeName.1 %in% "非森林"),] %>%
.[is.na(Macaca_sur), Macaca_sur := 0] %>%
.[, .(V1 = sum(Macaca_sur),.N), by= list(Year, Survey)] %>%
.[, Encounter_rate := V1/N] %>%
.[, c("V1","N") :=NULL]
View(Year.d)
Year.d <-
M.data %>%
.[analysis %in% "Y",] %>%
.[!(TypeName.1 %in% "非森林"),] %>%
.[is.na(Macaca_sur), Macaca_sur := 0] %>%
.[, .(V1 = sum(Macaca_sur),.N), by= list(Year, Survey)] %>%
.[, Encounter_rate := V1/N]
Year.d %>%
.[,.(mean_N = sum(N)), by = list(Year)]
Year.d %>%
.[,.(mean_N = mean(N)), by = list(Year)]
#樣點資料檢核
#---- load library
library(tidyverse)
library(readxl)
library(writexl)
library(sf)
#------------
M.data <- read_excel("./data/clean/for analysis Forestrydata_V1.xlsx",
sheet="Data")  %>%
mutate(Office = ordered(Office, c("羅東", "新竹", "東勢", "南投", "嘉義", "屏東", "花蓮", "臺東"))) %>%
mutate(Year = as.numeric(Year)) %>%
mutate(Survey = as.numeric(Survey)) %>%
mutate(Point = as.numeric(Point)) %>%
mutate(Month = as.numeric(Month)) %>%
mutate(Day = as.numeric(Day)) %>%
mutate(Macaca_sur = as.numeric(Macaca_sur)) %>%
mutate(Distance = as.numeric(Distance))
#-----------
#Altitude的Encounter_rate
Alt.d.n <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(N = n(), E = sum(Macaca_sur)/n()) %>%
group_by(Altitude_f) %>%
summarise(mean_N = mean(N),  y = quantile(E,0.75))
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "Elevation (m)", y = "Encounter rate (troop/point)") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
group_by(Altitude_f) %>% #確認中位數
summarise(mid = median(E))
#-----------
#Altitude的Encounter_rate
Alt.d.n <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(N = n(), E = sum(Macaca_sur)/n()) %>%
group_by(Altitude_f) %>%
summarise(mean_N = mean(N),  y = quantile(E,0.75))
Alt.d.n
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "Elevation (m)", y = "Encounter rate (troop/point)") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n())
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n())
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
boxplot(E ~ factor(Altitude_f), data = .)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
boxplot(E ~ factor(Altitude_f), data = ., plot=F)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
boxplot(E ~ factor(Altitude_f), data = ., plot=F)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "Elevation (m)", y = "Encounter rate (troop/point)") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
boxplot(E ~ factor(Altitude_f), data = .)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "Elevation (m)", y = "Encounter rate (troop/point)") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n())
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
write.csv(., "D:/待處理工作夾(做完要歸檔)/fff.csv
")
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
write.csv(., "D:/待處理工作夾(做完要歸檔)/fff.csv")
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "海拔 (m)", y = "相對密度 (猴群數/樣點)") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "海拔 (m)", y = "    ") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,500)),
labels = c(seq(250,3750,500)),
include.lowest = T) ) %>%
group_by(Altitude_f,Survey) %>%
summarise(E = sum(Macaca_sur)/n()) %>%
ggplot(., aes(x = Altitude_f, y = E)) +
geom_boxplot(size = 1, width = 0.4, fill= gray(.9))+
geom_text(data = Alt.d.n, aes(y = y+0.0025,label = paste0(mean_N,c("","","","","","",""))),
size = 4,
hjust = -0.1,
position = position_dodge(0.9))+
scale_y_continuous(breaks = seq(0,0.10,0.02), limits = c(0,0.10))+
labs(x = "   ", y = "    ") +
theme(
text = element_text(family="serif"),
panel.border = element_rect(size = 1.5,fill = NA),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 14,colour = "black"),
axis.title = element_text(size = 18,colour = "black",
vjust = -2, hjust = 0.5)
)
