panel.background = element_blank()
)
tmp <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Macaca_sur = factor(Macaca_sur,
levels = c("1", "0")))%>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,200)),
labels = c(seq(100,3900,200)),
include.lowest = T) )
ggplot(data = tmp,
aes(x = Altitude_f,
color = Macaca_sur,
fill = Macaca_sur))+
geom_bar(position="stack")+
theme(
axis.text.x = element_text(angle = 270, vjust =0),
legend.position = "top",
panel.background = element_blank()
)
tmp %>% group_by(Macaca_sur, Altitude_f) %>% summarise(N = n())
tmp %>% group_by(Macaca_sur, Altitude_f) %>% summarise(N = n()) %>% reshape2::dcast(Altitude_f ~ Macaca_sur, var.value = "N")
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,100)),
labels = c(seq(50,4000,100)),
include.lowest =T) ) %>%
group_by(Altitude_f, Year) %>%
summarise(N = n())
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,100)),
labels = c(seq(50,4000,100)),
include.lowest =T) ) %>%
group_by(Altitude_f, Year) %>%
summarise(N = n()) %>%
ggplot(., aes(x = Altitude_f, y = N))+
geom_point()
tmp <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Macaca_sur = factor(Macaca_sur,
levels = c("1", "0")))%>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,200)),
labels = c(seq(100,3900,200)),
include.lowest = T) )
ggplot(data = tmp,
aes(x = Altitude_f,
color = Macaca_sur,
fill = Macaca_sur))+
geom_bar(position="stack")+
theme(
axis.text.x = element_text(angle = 270, vjust =0),
legend.position = "top",
axis.line = element_line(color = "black"),
panel.background = element_blank()
)
tmp <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Macaca_sur = factor(Macaca_sur,
levels = c("1", "0")))%>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,200)),
labels = c(seq(100,3900,200)),
include.lowest = T) )
ggplot(data = tmp,
aes(x = Altitude_f,
color = Macaca_sur,
fill = Macaca_sur))+
geom_bar(position="stack")+
scale_y_continuous(expand = NULL)+
theme(
axis.text.x = element_text(angle = 270, vjust =0),
legend.position = "top",
axis.line = element_line(color = "black"),
panel.background = element_blank()
)
tmp <-
M.data %>%
filter(analysis %in% "Y") %>%
mutate(Macaca_sur = factor(Macaca_sur,
levels = c("1", "0")))%>%
mutate(Altitude_f =cut(Altitude,
breaks = c(seq(0,4000,200)),
labels = c(seq(100,3900,200)),
include.lowest = T) )
ggplot(data = tmp,
aes(x = Altitude_f,
color = Macaca_sur,
fill = Macaca_sur))+
geom_bar(position="stack")+
theme(
axis.text.x = element_text(angle = 270, vjust =0),
legend.position = "top",
axis.line = element_line(color = "black"),
panel.background = element_blank()
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lme4)
library(car)
library(multcomp)
library(readxl)
library(MuMIn)
M.data <- read_excel("./data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data")  %>%
bind_rows(
read_excel("./data/clean/for analysis Forestrydata_V1.xlsx",
sheet="Data"))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(here("./data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data"))  %>%
bind_rows(
read_excel(here("./data/clean/for analysis Forestrydata_V1.xlsx",
sheet="Data")))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
library(tidyverse)
library(lme4)
library(car)
library(multcomp)
library(readxl)
library(MuMIn)
library(here)
library(flextable)
M.data <- read_excel(here("./data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data"))  %>%
bind_rows(
read_excel(here("./data/clean/for analysis Forestrydata_V1.xlsx",
sheet="Data")))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(here("data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data"))  %>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx",
sheet="Data")))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
knitr::opts_chunk$set(echo = TRUE)
read_excel(here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")
read_excel(here("data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data"))
library(tidyverse)
library(lme4)
library(car)
library(multcomp)
library(readxl)
library(MuMIn)
library(here)
library(flextable)
read_excel(here("data/clean/for analysis Forestrydata_2021_V1.xlsx",
sheet="Data"))
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data"))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") %>%
mutate(Point = as.character(Point)))  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate_at(c("Point", "Macaca_sur"),  as.character)%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") ))  %>%
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate_at(c("Point", "Macaca_sur"),  as.character)%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") )  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate_at(c("Point", "Macaca_sur"),  as.numeric)%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") )  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.character(Point))%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") )  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point))%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data") )  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point))%>%
bind_rows(
read_excel(here("data/clean/for analysis Forestrydata_V1.xlsx"),
sheet="Data")%>%
mutate(Macaca_sur = as.numeric(Macaca_sur) )  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point))%>%
bind_rows(
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur)
)  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point)%>%
bind_rows(
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur)
)  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur)
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point)%>%
bind_rows(
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur))
)  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point))%>%
bind_rows(
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur))
)  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lme4)
library(car)
library(multcomp)
library(readxl)
library(MuMIn)
library(here)
library(flextable)
M.data <- read_excel(
here("data/clean/for analysis Forestrydata_2021_V1.xlsx"),
sheet="Data")  %>%
mutate(Point = as.numeric(Point))%>%
bind_rows(
read_excel(
here("data/clean/for analysis Forestrydata_V1.xlsx"), sheet="Data") %>%
mutate(Macaca_sur = as.numeric(Macaca_sur))
)  %>%
mutate(Office = ordered(Office,
levels = c("羅東", "新竹", "東勢", "南投",
"嘉義", "屏東", "花蓮", "臺東"),
labels = c("Luodong", "Hsinchu", "Dougshih", "Nantou",
"Chiayi", "Pingtung", "Hualien", "Taitung"))) %>%
mutate_at(c("Year", "Survey","Point","Month",
"Day", "Macaca_sur", "Distance"), as.numeric) %>%
mutate(TypeName.1 = case_when(
TypeName.1 %in% "闊葉林" ~ "broad_leaved",
TypeName.1 %in% "針葉林" ~ "coniferous",
TypeName.1 %in% "竹林" ~ "Bamboo",
TypeName.1 %in% "混淆林" ~ "mixed",
TypeName.1 %in% "非森林" ~ "Not forest"
)) %>%
filter(analysis %in% "Y")
M.data <- M.data %>%
mutate( Year.re = Year - min(Year) + 1)
df <-
M.data
allFit(glmer(Macaca_sur ~ TypeName.1  + Year.re + Altitude + julian.D + Office +  (1|Site_N) + (Year.re|Site_N),
family = binomial, data = df))   #嘗試使用一系列優化程序重新擬合glmer模型
